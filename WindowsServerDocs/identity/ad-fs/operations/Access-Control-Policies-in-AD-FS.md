---
description: 深入瞭解： Windows Server 2016 中的存取控制原則 AD FS
ms.assetid: 102eeeb1-6c55-42a2-b321-71a7dab46146
title: AD FS Windows Server 2016 中的存取控制原則
author: billmath
ms.author: billmath
manager: femila
ms.date: 05/31/2017
ms.topic: article
ms.openlocfilehash: 83f1efb62f3f7910f0866b63186ef97b11966fe5
ms.sourcegitcommit: 528bdff90a7c797cdfc6839e5586f2cd5f0506b0
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "97977473"
---
# <a name="access-control-policies-in-windows-server-2016-ad-fs"></a>Windows Server 2016 AD FS 中的存取控制原則


## <a name="access-control-policy-templates-in-ad-fs"></a>AD FS 中的存取控制原則範本
Active Directory 同盟服務現在支援使用存取控制原則範本。  藉由使用存取控制原則範本，系統管理員可以藉由將原則範本指派給信賴憑證者群組 (RPs) 來強制執行原則設定。 系統管理員也可以進行原則範本的更新，而如果不需要使用者互動，則會自動將變更套用至信賴憑證者。

## <a name="what-are-access-control-policy-templates"></a>什麼是存取控制原則範本？
原則處理的 AD FS 核心管線有三個階段：驗證、授權和宣告發行。 目前，AD FS 系統管理員必須分別為每個階段設定原則。  這也牽涉到了解這些原則的含意，以及這些原則之間是否有相依性。 此外，系統管理員必須瞭解宣告規則語言並撰寫自訂規則，才能啟用一些簡單/一般原則 (例如 封鎖外部存取) 。

存取控制原則範本的用途是取代舊版模型，系統管理員必須使用宣告語言來設定發佈授權規則。  發行授權規則的舊 PowerShell Cmdlet 仍然適用，但是它與新的模型互斥。 系統管理員可以選擇使用新的模型或舊的模型。  新模型可讓系統管理員控制何時授與存取權，包括強制執行多重要素驗證。

存取控制原則範本會使用允許模型。  這表示根據預設，沒有人可以存取，而且必須明確授與存取權。  不過，這不只是全部或不允許的。  系統管理員可以將例外狀況新增至允許規則。  例如，系統管理員可能會想要根據特定的網路來授與存取權，方法是選取這個選項，並指定 IP 位址範圍。  但系統管理員可能會新增和例外，例如，系統管理員可以從特定網路新增例外狀況，並指定該 IP 位址範圍。

![螢幕擷取畫面，顯示存取控制原則的查看位置。](media/Access-Control-Policies-in-AD-FS/ADFSACP2.PNG)

## <a name="built-in-access-control-policy-templates-vs-custom-access-control-policy-templates"></a>內建的存取控制原則範本與自訂存取控制原則範本
AD FS 包含數個內建的存取控制原則範本。  這些都是以一組相同的原則需求（例如 Office 365 的用戶端存取原則）為目標的一些常見案例。  無法修改這些範本。

![顯示內建存取控制原則的螢幕擷取畫面。](media/Access-Control-Policies-in-AD-FS/ADFSACP3.PNG)

為了提供更大的彈性來滿足您的商務需求，系統管理員可以建立自己的存取原則範本。  這些可以在建立之後修改，自訂原則範本的變更將會套用至由這些原則範本控制的所有 RPs。  若要新增自訂原則範本，只需按一下 [AD FS 管理] 內的 [新增存取控制原則]。

若要建立原則範本，系統管理員必須先指定在哪些條件下，要求將獲得權杖發行和/或委派的授權。 條件和動作選項如下表所示。   具有不同或新值的系統管理員可以進一步設定粗體的條件。 系統管理員也可以指定例外狀況（如果有的話）。 當符合條件時，如果指定了例外狀況，且傳入的要求符合例外狀況中指定的條件，則不會觸發允許動作。

|允許使用者|Except|
| --- | --- |
 |從 **特定** 網路|從 **特定** 網路<p>從 **特定** 群組<p>從具有 **特定** 信任層級的裝置<p>使用要求中的 **特定** 宣告|
|從 **特定** 群組|從 **特定** 網路<p>從 **特定** 群組<p>從具有 **特定** 信任層級的裝置<p>使用要求中的 **特定** 宣告|
|從具有 **特定** 信任層級的裝置|從 **特定** 網路<p>從 **特定** 群組<p>從具有 **特定** 信任層級的裝置<p>使用要求中的 **特定** 宣告|
|使用要求中的 **特定** 宣告|從 **特定** 網路<p>從 **特定** 群組<p>從具有 **特定** 信任層級的裝置<p>使用要求中的 **特定** 宣告|
|和需要多重要素驗證|從 **特定** 網路<p>從 **特定** 群組<p>從具有 **特定** 信任層級的裝置<p>使用要求中的 **特定** 宣告|

如果系統管理員選取多個條件，則為 **和** 關聯性。 動作互斥，而且一個原則規則只能選擇一個動作。 如果系統管理員選取多個例外狀況，則為 **或** 關聯性。 有幾個原則規則範例如下所示：

|**原則**|**原則規則**|
| --- | --- |
|外部網路存取需要 MFA<p>允許所有使用者|**規則 #1**<p>從 **外部** 網路<p>和搭配 MFA<p>允許<p>**規則 # 2**<p>從 **內部** 網路<p>允許|
|不允許外部存取，但非 FTE 除外<p>允許已加入工作場所的裝置上的 FTE 內部網路存取|**規則 #1**<p>從 **外部** 網路<p>從 **非 FTE** 群組<p>允許<p>**規則 #2**<p>從 **內部** 網路<p>從已 **加入工作場所** 的裝置<p>和來自 **FTE** 群組<p>允許|
|外部網路存取需要 MFA，但 "service admin" 除外<p>允許所有使用者存取|**規則 #1**<p>從 **外部** 網路<p>和搭配 MFA<p>允許<p>**服務管理群組** 除外<p>**規則 #2**<p>always<p>允許|
|從外部網路存取的非工作地點加入裝置需要 MFA<p>允許內部網路和外部網路存取的 AD 網狀架構|**規則 #1**<p>從 **內部** 網路<p>以及從 **AD Fabric** 群組<p>允許<p>**規則 #2**<p>從 **外部** 網路<p>以及從 **非工作地點加入** 的裝置<p>以及從 **AD Fabric** 群組<p>和搭配 MFA<p>允許<p>**規則 #3**<p>從 **外部** 網路<p>從已 **加入工作場所** 的裝置<p>以及從 **AD Fabric** 群組<p>允許|

## <a name="parameterized-policy-template-vs-non-parameterized-policy-template"></a>參數化原則範本與非參數化原則範本
存取控制原則可以是

參數化原則範本是具有參數的原則範本。 將此範本指派給 RPs.An 系統管理員時，系統管理員必須輸入參數的值，才能在建立參數化原則範本之後對其進行變更。  參數化原則的範例是內建原則，允許特定群組。  只要將此原則套用至 RP，就必須指定這個參數。

![顯示參數化原則範本範例的螢幕擷取畫面。](media/Access-Control-Policies-in-AD-FS/ADFSACP5.PNG)

非參數化原則範本是沒有參數的原則範本。 系統管理員可以將此範本指派給 RPs，而不需要任何輸入，而且可以在建立之後變更非參數化原則範本。  其中一個範例是內建原則，允許所有人和要求 MFA。

![顯示非參數化原則範本範例的螢幕擷取畫面。](media/Access-Control-Policies-in-AD-FS/ADFSACP4.PNG)

## <a name="how-to-create-a-non-parameterized-access-control-policy"></a>如何建立非參數化存取控制原則
若要建立非參數化的存取控制原則，請使用下列程式

#### <a name="to-create-a-non-parameterized-access-control-policy"></a>建立非參數化存取控制原則

1.  從左側的 AD FS 管理] 中選取 [存取控制原則]，然後在滑鼠右鍵上按一下 [新增存取控制原則]。

2.  輸入名稱和描述。  例如：允許使用者使用已驗證的裝置。

3.  **如果符合下列任一規則**，請在 [允許存取] 下按一下 [**新增**]。

4.  在 [允許] 底下，勾選 [**來自具有特定信任層級的裝置**] 旁的核取方塊

5.  在底部選取加底線的 **特定**

6.  從快顯視窗中，從下拉式清單中選取 [ **已驗證** ]。  按一下 [確定]  。

    ![顯示如何選取裝置信任層級的螢幕擷取畫面。](media/Access-Control-Policies-in-AD-FS/ADFSACP6.PNG)

7.  按一下 [確定]  。 按一下 [確定]  。

    ![顯示如何接受原則變更的螢幕擷取畫面。](media/Access-Control-Policies-in-AD-FS/ADFSACP7.PNG)

## <a name="how-to-create-a-parameterized-access-control-policy"></a>如何建立參數化存取控制原則
若要建立參數化存取控制原則，請使用下列程式

#### <a name="to-create-a-parameterized-access-control-policy"></a>建立參數化存取控制原則

1.  從左側的 AD FS 管理] 中選取 [存取控制原則]，然後在滑鼠右鍵上按一下 [新增存取控制原則]。

2.  輸入名稱和描述。  例如：允許具有特定宣告的使用者。

3.  **如果符合下列任一規則**，請在 [允許存取] 下按一下 [**新增**]。

4.  在 [允許] 底下，勾選 **要求中的特定宣告** 旁的核取方塊

5.  在底部選取加底線的 **特定**

6.  從彈出的視窗中，選取 **指派存取控制原則時指定的參數**。  按一下 [確定]  。

    ![顯示指派存取控制原則選項時所指定之參數的螢幕擷取畫面。](media/Access-Control-Policies-in-AD-FS/ADFSACP8.PNG)

7.  按一下 [確定]  。 按一下 [確定]  。

    ![顯示如何接受選取之選項的螢幕擷取畫面。](media/Access-Control-Policies-in-AD-FS/ADFSACP9.PNG)

## <a name="how-to-create-a-custom-access-control-policy-with-an-exception"></a>如何建立具有例外狀況的自訂存取控制原則
若要建立具有例外狀況的存取控制原則，請使用下列程式。

#### <a name="to-create-a-custom-access-control-policy-with-an-exception"></a>若要建立具有例外狀況的自訂存取控制原則

1.  從左側的 AD FS 管理] 中選取 [存取控制原則]，然後在滑鼠右鍵上按一下 [新增存取控制原則]。

2.  輸入名稱和描述。  例如：允許已驗證裝置但未受管理的使用者。

3.  **如果符合下列任一規則**，請在 [允許存取] 下按一下 [**新增**]。

4.  在 [允許] 底下，勾選 [**來自具有特定信任層級的裝置**] 旁的核取方塊

5.  在底部選取加底線的 **特定**

6.  從快顯視窗中，從下拉式清單中選取 [ **已驗證** ]。  按一下 [確定]  。

7.  在 [例外] 下，勾選 [**來自具有特定信任層級的裝置**] 旁的核取方塊

8.  在底部的 [例外] 下，選取加底線的 **特定**

9. 從快顯視窗中，從下拉式清單中選取 [ **managed** ]。  按一下 [確定]  。

10. 按一下 [確定]  。 按一下 [確定]  。

    ![顯示 [螢幕編輯器] 對話方塊的螢幕擷取畫面。](media/Access-Control-Policies-in-AD-FS/ADFSACP10.PNG)

## <a name="how-to-create-a-custom-access-control-policy-with-multiple-permit-conditions"></a>如何建立具有多個允許條件的自訂存取控制原則
若要建立具有多個允許條件的存取控制原則，請使用下列程式

#### <a name="to-create-a-parameterized-access-control-policy"></a>建立參數化存取控制原則

1.  從左側的 AD FS 管理] 中選取 [存取控制原則]，然後在滑鼠右鍵上按一下 [新增存取控制原則]。

2.  輸入名稱和描述。  例如：允許具有特定宣告和特定群組的使用者。

3.  **如果符合下列任一規則**，請在 [允許存取] 下按一下 [**新增**]。

4.  在 [允許] 下，核取 [ **從特定群組** ] 旁的方塊，並在 **要求中放置特定的宣告**

5.  在底部，選取 [群組] 旁邊第一個條件的加底線 **特定**

6.  從彈出的視窗中，選取 **指派原則時指定的參數**。  按一下 [確定]  。

7.  在底部，選取 [宣告] 旁邊第二個條件的加底線 **特定**

8.  從彈出的視窗中，選取 **指派存取控制原則時指定的參數**。  按一下 [確定]  。

9. 按一下 [確定]  。 按一下 [確定]  。

![存取控制原則](media/Access-Control-Policies-in-AD-FS/ADFSACP12.PNG)

## <a name="how-to-assign-an-access-control-policy-to-a-new-application"></a>如何將存取控制原則指派給新的應用程式
將存取控制原則指派給新的應用程式相當簡單，而且現在已經整合到嚮導中，以新增 RP。  在 [信賴憑證者信任] 中，您可以選取您想要指派的存取控制原則。  這是建立新的信賴憑證者信任時的必要條件。

![顯示 [選擇存取控制原則] 畫面的螢幕擷取畫面。](media/Access-Control-Policies-in-AD-FS/ADFSACP13.PNG)

## <a name="how-to-assign-an-access-control-policy-to-an-existing-application"></a>如何將存取控制原則指派給現有的應用程式
將存取控制原則指派給現有的應用程式只需從信賴憑證者信任中選取應用程式，然後在滑鼠右鍵的 [ **編輯存取控制原則**] 上按一下滑鼠右鍵。

![顯示重試方信任應用程式的螢幕擷取畫面。](media/Access-Control-Policies-in-AD-FS/ADFSACP14.PNG)

您可以從這裡選取存取控制原則，並將它套用至應用程式。

![顯示如何編輯存取控制原則的螢幕擷取畫面。](media/Access-Control-Policies-in-AD-FS/ADFSACP15.PNG)

## <a name="see-also"></a>另請參閱
[AD FS 操作](../ad-fs-operations.md)
