---
description: 深入瞭解：宣告管線的角色
ms.assetid: ffb9d63c-ba7c-4ad1-b814-6db67f98c943
title: 宣告管線的角色
author: billmath
ms.author: billmath
manager: femila
ms.date: 05/31/2017
ms.topic: article
ms.openlocfilehash: 3925351c6b625a52ace096f71f790e7056beb3c2
ms.sourcegitcommit: 65b6de6b44d41f1180c45db11cdd60cb2a093b46
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 12/10/2020
ms.locfileid: "97050466"
---
# <a name="the-role-of-the-claims-pipeline"></a>宣告管線的角色
Active Directory 同盟服務 AD FS 中的宣告 \( 管線 \) 代表宣告必須遵循同盟服務之後才能發出的路徑。 同盟服務管理整個端 \- 對端程式 \- ，透過宣告管線的各個階段來流動宣告，也包括宣告規則引擎的宣告規則處理。

如需宣告規則的詳細資訊，請參閱宣告 [規則的角色](The-Role-of-Claim-Rules.md)。 如需宣告規則引擎如何處理規則的詳細資訊，請參閱 [The Role of the Claims Engine](The-Role-of-the-Claims-Engine.md)。

下列章節會更詳細地討論同盟服務監視的程序。

## <a name="claims-pipeline-process"></a>宣告管線處理程序
宣告管線程式是由三個高層 \- 級的階段所組成。 此程序的每個階段會初始化宣告規則引擎來處理該階段的特定宣告規則。 這些階段包含 \( 它們出現的順序 \) ：

1.  接受連入宣告 - 宣告管線中的這個階段用來從權杖擷取連入宣告，並排除未預期或未受信任的宣告。 在擷取之後，組成宣告提供者信任的接受轉換規則集的接受規則即會執行。 這些規則可以用來傳遞或加入之後可以在宣告管線的後續階段中使用的新宣告。 這個階段的輸出可做為第二個和第三個階段的輸入。

2.  授權宣告要求者 - 宣告引擎會使用這個階段依據權杖要求者是否被允許取得指定信賴憑證者的權杖，來發出允許或拒絕宣告。 不過，在發生此情況之前，會執行構成發行授權規則集或信賴憑證者信任的委派授權規則集的授權規則。

3.  發出連出宣告 - 這個階段是用來發出連出宣告並將它們沿著將被封裝為安全性權杖的管線傳送。 不過，在發生此情況之前，會執行組成信賴憑證者信任的發行轉換規則集，這將會決定哪些宣告會發出為連出宣告。

上述所有三個階段會執行宣告規則處理，但使用不同的規則集。 如上所述，每個階段都有一組相關聯的規則，這些規則是以傳入宣告的簽發者為基礎， \( 接受規則 \) 或 claimincludes 發出 \( 授權和發佈規則的目標服務 \) 。

宣告是權杖 \- 中立的，但會透過封裝于安全性權杖的網路傳輸。 宣告規則會對宣告運作，而不論傳入或傳出的安全性權杖的格式為何。

宣告規則包含系統管理員 \- 定義的邏輯，宣告引擎會接受傳入宣告、根據要求者的身分識別授權宣告，以及信賴憑證者所需的發出宣告。 最後，在宣告行經宣告管線之後，宣告引擎會決定將移到將發出的安全性權杖的宣告。

如下圖所示，宣告管線負責 \- 透過各種管線階段流動宣告的整個端對端程式， \- 以產生將透過信賴憑證者信任傳送的已發行宣告。 圖中的連出宣告表示發出的宣告。

![AD FS 角色](media/adfs2_pipeline.gif)

雖然未在圖例中顯示，它是在每個階段執行規則的實際處理的宣告引擎。 如需詳細資訊，請參閱 [The Role of the Claims Engine](The-Role-of-the-Claims-Engine.md)。


